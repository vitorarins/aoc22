package day14_test

import (
	"testing"

	"github.com/google/go-cmp/cmp"
	"github.com/vitorarins/aoc22/day14"
)

func TestPourGrain(t *testing.T) {
	testCases := map[string]struct {
		input     *day14.Cave
		startSand day14.Point
		want      *day14.Cave
		wantLimit bool
	}{
		"grain0": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 500, Y: 8}: "o",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain1": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 500, Y: 8}: "o",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain2": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain5": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 8}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain22": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 2}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain24": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 497, Y: 5}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 2}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 495, Y: 8}: "o",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 497, Y: 5}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 2}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: false,
		},
		"grain25": {
			input: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 495, Y: 8}: "o",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 497, Y: 5}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 2}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			startSand: day14.Point{500, 0},
			want: &day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",

					{X: 495, Y: 8}: "o",

					{X: 497, Y: 8}: "o",
					{X: 498, Y: 8}: "o",
					{X: 499, Y: 8}: "o",
					{X: 500, Y: 8}: "o",
					{X: 501, Y: 8}: "o",

					{X: 498, Y: 7}: "o",
					{X: 499, Y: 7}: "o",
					{X: 500, Y: 7}: "o",
					{X: 501, Y: 7}: "o",

					{X: 499, Y: 6}: "o",
					{X: 500, Y: 6}: "o",
					{X: 501, Y: 6}: "o",

					{X: 497, Y: 5}: "o",

					{X: 499, Y: 5}: "o",
					{X: 500, Y: 5}: "o",
					{X: 501, Y: 5}: "o",

					{X: 499, Y: 4}: "o",
					{X: 500, Y: 4}: "o",
					{X: 501, Y: 4}: "o",

					{X: 499, Y: 3}: "o",
					{X: 500, Y: 3}: "o",
					{X: 501, Y: 3}: "o",

					{X: 500, Y: 2}: "o",

					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
			wantLimit: true,
		},
	}

	for n, tc := range testCases {
		t.Run(n, func(t *testing.T) {
			got, gotLimit := day14.PourGrain(tc.input, tc.startSand)

			if diff := cmp.Diff(tc.want, got); diff != "" {
				t.Errorf("cave mismatch (-want +got):\n%s", diff)
			}

			if diff := cmp.Diff(tc.wantLimit, gotLimit); diff != "" {
				t.Errorf("cave limit reached mismatch (-want +got):\n%s", diff)
			}
		})
	}
}

func TestParseCave(t *testing.T) {
	testCases := map[string]struct {
		input      string
		withBottom bool
		want       day14.Cave
	}{
		"cave0": {
			input: `498,4 -> 498,6 -> 496,6
503,4 -> 502,4 -> 502,9 -> 494,9`,
			withBottom: false,
			want: day14.Cave{
				Rocks: map[day14.Point]string{
					{X: 494, Y: 9}: "#",
					{X: 495, Y: 9}: "#",
					{X: 496, Y: 6}: "#",
					{X: 496, Y: 9}: "#",
					{X: 497, Y: 6}: "#",
					{X: 497, Y: 9}: "#",
					{X: 498, Y: 4}: "#",
					{X: 498, Y: 5}: "#",
					{X: 498, Y: 6}: "#",
					{X: 498, Y: 9}: "#",
					{X: 499, Y: 9}: "#",
					{X: 500, Y: 9}: "#",
					{X: 501, Y: 9}: "#",
					{X: 502, Y: 4}: "#",
					{X: 502, Y: 5}: "#",
					{X: 502, Y: 6}: "#",
					{X: 502, Y: 7}: "#",
					{X: 502, Y: 8}: "#",
					{X: 502, Y: 9}: "#",
					{X: 503, Y: 4}: "#",
				},
				StartX: 494,
				LimitX: 503,
				LimitY: 9,
			},
		},
	}

	for n, tc := range testCases {
		t.Run(n, func(t *testing.T) {
			got := day14.ParseCave(tc.input, tc.withBottom)

			if diff := cmp.Diff(tc.want, got); diff != "" {
				t.Errorf("cave mismatch (-want +got):\n%s", diff)
			}
		})
	}
}

func TestGetSandUnits(t *testing.T) {
	testCases := map[string]struct {
		input  string
		bottom bool
		want   int
	}{
		"sand0": {
			input: `
498,4 -> 498,6 -> 496,6
503,4 -> 502,4 -> 502,9 -> 494,9`,
			bottom: false,
			want:   24,
		},
		"sand1": {
			input: `
498,4 -> 498,6 -> 496,6
503,4 -> 502,4 -> 502,9 -> 494,9`,
			bottom: true,
			want:   93,
		},
	}

	for n, tc := range testCases {
		t.Run(n, func(t *testing.T) {
			got := day14.GetSandUnits(tc.input, tc.bottom)

			if diff := cmp.Diff(tc.want, got); diff != "" {
				t.Errorf("sand mismatch (-want +got):\n%s", diff)
			}
		})
	}
}
